<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sorteio de Natal</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <audio id="bellSound" 
    src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_6f7a55d80b.mp3?filename=christmas-bells-109274.mp3" 
    preload="auto">
  </audio>

  <div class="card">
    <h1>ğŸ„ Sorteio de Natal ğŸ</h1>
    <p>Digite seu nome abaixo e participe do sorteio. Cada dispositivo pode sortear apenas uma vez!</p>

    <input id="name" placeholder="Digite seu nome" />
    <button id="drawBtn">Sortear Agora</button>

    <hr />

    <h3>ğŸ… Lista de participantes</h3>
    <pre id="list">Carregando...</pre>

    <hr />

    <p>Este dispositivo sÃ³ poderÃ¡ sortear uma vez. Boa sorte! ğŸ€</p>
    <div id="result"></div>
  </div>

  <script>

    const API = "http://localhost:3000"; // altere se o backend estiver hospedado em outro lugar
    const btnSortear = document.getElementById("btnSortear");
    const resultado = document.getElementById("resultado");
    const somSino = document.getElementById("somSino");

    btnSortear.addEventListener("click", async () => {
      const res = await fetch(`${API}/draw`);
      const data = await res.json();

      resultado.style.display = "block";
      resultado.textContent = data.nome || data.mensagem;
      somSino.play();
    });

    // Efeito de neve
    function criarNeve() {
      const floco = document.createElement("div");
      floco.textContent = "â„";
      floco.classList.add("snowflake");
      floco.style.left = Math.random() * 100 + "vw";
      floco.style.animationDuration = Math.random() * 3 + 2 + "s";
      floco.style.fontSize = Math.random() * 10 + 10 + "px";
      document.body.appendChild(floco);
      setTimeout(() => floco.remove(), 5000);
    }

    setInterval(criarNeve, 200);

  </script>
</body>
</html>
